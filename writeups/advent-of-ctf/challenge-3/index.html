<!DOCTYPE html>
<html lang="en">
<head>
<!-- 21 Dec. 2022 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advent of CTF - Challenge 3</title>
<meta name="author" content="Arjen Wiersma" />
<meta name="generator" content="Org Mode" />
<meta description='Writings by Arjen'/>
<link rel='alternate' type='application+rss/xml' title='Writings by Arjen' href='/posts/rss.xml'/>
<link rel="stylesheet" href="../../../css/theme.css?v=20216e086cf8a20ead56908f3be0bcda6af2531ec1a68c9058ee7495590f57ea" type="text/css">
</head>
<body>
<main id="content" class="content">
<header>
<h1 class="title">Advent of CTF - Challenge 3</h1>
<p class="subtitle" role="doc-subtitle">&ldquo;Javascript&rdquo;</p>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org0218a23">Challenge</a></li>
<li><a href="#orgd12848d">Solution</a></li>
</ul>
</div>
</nav>

<section id="outline-container-org0218a23" class="outline-2">
<h2 id="org0218a23">Challenge</h2>
<div class="outline-text-2" id="text-org0218a23">
<p>
This challenge is aimed at understanding how web pages can be made more interactive, using Javascript. Javascript is a programming language for the web that is used in pretty much every web application you will come across.
</p>

<p>
The things you learn in this challenge:
</p>

<ul class="org-ul">
<li>How you can view Javascript in your browser</li>
<li>Read some Javascript to figure out what is happening</li>
<li>Running Javascript you wrote yourself</li>
</ul>
</div>
</section>

<section id="outline-container-orgd12848d" class="outline-2">
<h2 id="orgd12848d">Solution</h2>
<div class="outline-text-2" id="text-orgd12848d">
<p>
The challenge opens up to a familiar sight; the login screen that was used in <a href="./../challenge-2/index.html">Challenge 2</a>. The teaser still says not to try too hard, but surely it will not be as simple as the last one.
</p>


<figure id="org91d0cdf">
<img src="index_att/login.png" alt="login.png">

<figcaption><span class="figure-number">Figure 1: </span>The login screen</figcaption>
</figure>

<p>
Browsing the source code of the HTML page, as we did in <a href="./../challenge-1/index.html">Challenge 1</a> shows that this application uses a Javascript file. The name of the file is <code>login.js</code>, so that looks promising.
</p>


<figure id="org4703fdf">
<img src="index_att/javascript-in-html.png" alt="javascript-in-html.png">

<figcaption><span class="figure-number">Figure 2: </span>Javascript source reference</figcaption>
</figure>

<p>
Using the DevTools (F12) it is possible to examine the files used by an application. Go to <i>Debugger</i> (or <i>Sources</i> in Chrome) and click on <code>login.js</code>. You will be able to see the full Javacsript source that controls the login form.
</p>


<figure id="org99387a3">
<img src="index_att/javascript-source.png" alt="javascript-source.png">

<figcaption><span class="figure-number">Figure 1: </span>Javascript source in the DevTools</figcaption>
</figure>

<p>
I have copied over the source of the function below so that it can be examined more easily.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>checkPass()</label><pre class="src src-javascript"><span class="org-keyword">var</span> <span class="org-variable-name">username</span> = document.getElementById(<span class="org-string">'username'</span>).value;
<span class="org-keyword">var</span> <span class="org-variable-name">password</span> = document.getElementById(<span class="org-string">'password'</span>).value;

<span class="org-keyword">var</span> <span class="org-variable-name">novi</span> = <span class="org-string">'-NOVI'</span>;

<span class="org-keyword">if</span> (password == btoa(username + novi)) {
    window.setTimeout(<span class="org-keyword">function</span>() {
        window.location.assign(<span class="org-string">'inde'</span> + <span class="org-string">'x.php?username='</span>+
                               username +<span class="org-string">'&amp;password='</span> + password);
    }, 500);
}
</pre>
</div>

<p>
The logic of the function is quite simple. First it grabs the <code>username</code> and <code>password</code> from the form. These will contain the entries that can be entered by us, the user. Then a variable called <code>novi</code> is created and assigned the value <code>-NOVI</code>. The password is checked to ensure that the <code>password</code> that was entered is equal to <code>btoa(username + novi)</code>. This means that if the username <code>arjen</code> was entered, the password has to be <code>btoa("arjen-NOVI")</code>. The function <code>btoa</code> creates a Base64 string.
</p>

<p>
Switch to the <i>Console</i> view of the DevTools and copy <code>btoa("arjen-NOVI")</code> into the screen. It might warn you that copying is not allowed, follow the instructions to allow it. You should get a nice Base64 string.
</p>


<figure id="org8959803">
<img src="index_att/base64-password.png" alt="base64-password.png">

<figcaption><span class="figure-number">Figure 1: </span>Base64 password has been created</figcaption>
</figure>

<p>
Now you can log in with the <code>username</code> of <code>arjen</code> and the <code>password</code> set to <code>YXJqZW4tTk9WSQ==</code>. You will be presented with the flag for this challenge.
</p>


<figure id="org4b27a0c">
<img src="index_att/flag.png" alt="flag.png">

<figcaption><span class="figure-number">Figure 1: </span>The flag for this challenge</figcaption>
</figure>

<p>
You can grab your points from the CTFd instance, you should have at least 600 points (if you did not use the hints). Also don&rsquo;t forget to grab your badge from the <a href="https://badges.adventofctf.com">Badge Server</a>.
</p>


<figure id="orgafa2954">
<img src="index_att/badge.png" alt="badge.png">

<figcaption><span class="figure-number">Figure 1: </span>The badge for challenge 3</figcaption>
</figure>

<p>
You have solved the challenge.
</p>

<p>
Go back to the <a href="../../../index.html">homepage</a>.
</p>
</div>
</section>
</main>
<footer id="postamble" class="status">
<p class="author">Author: Arjen Wiersma</p>
<p class="date">Created: 21 Dec. 2022</p>
</footer>
</body>
</html>