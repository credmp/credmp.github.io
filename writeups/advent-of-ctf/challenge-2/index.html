<!DOCTYPE html>
<html lang="en">
<head>
<!-- 21 Dec. 2022 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advent of CTF - Challenge 2</title>
<meta name="author" content="Arjen Wiersma" />
<meta name="generator" content="Org Mode" />
<meta description='Writings by Arjen'/>
<link rel='alternate' type='application+rss/xml' title='Writings by Arjen' href='/posts/rss.xml'/>
<link rel="stylesheet" href="../../../css/theme.css?v=20216e086cf8a20ead56908f3be0bcda6af2531ec1a68c9058ee7495590f57ea" type="text/css">
</head>
<body>
<main id="content" class="content">
<header>
<h1 class="title">Advent of CTF - Challenge 2</h1>
<p class="subtitle" role="doc-subtitle">&ldquo;Cookiemonster&rdquo;</p>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orge3ad668">Challenge</a></li>
<li><a href="#orgdeafdde">Solution</a></li>
</ul>
</div>
</nav>

<section id="outline-container-orge3ad668" class="outline-2">
<h2 id="orge3ad668">Challenge</h2>
<div class="outline-text-2" id="text-orge3ad668">
<p>
This challenge focuses on the way data is stored in the browser and the way it can be used to change the workings of a backend service.
</p>

<p>
The things you will learn are:
</p>

<ul class="org-ul">
<li>How cookies are stored in a browser</li>
<li>Identifying structures with <b>Base64</b></li>
<li>URL Encoding</li>
<li>Manipulating JSON structures</li>
</ul>
</div>
</section>

<section id="outline-container-orgdeafdde" class="outline-2">
<h2 id="orgdeafdde">Solution</h2>
<div class="outline-text-2" id="text-orgdeafdde">
<p>
Once the challenge has loaded a webpage is presented with a login form.
</p>


<figure id="orgfd271f4">
<img src="index_att/login.png" alt="login.png">

<figcaption><span class="figure-number">Figure 1: </span>Login screen</figcaption>
</figure>

<p>
A trained CTF player might try various advanced techniques, however the teaser below the login form says &ldquo;Do not try too hard&rdquo;. Entering any combination of username / password will get you into the system.
</p>


<figure id="org46126d3">
<img src="index_att/guest-mode.png" alt="guest-mode.png">

<figcaption><span class="figure-number">Figure 2: </span>Logged in as guest</figcaption>
</figure>

<p>
As this is only the 2nd challenge it is not expected that the challenge will be overly complex. After you login you will notice that a cookie has been set. A hint is given by the <i>&ldquo;Whoop Whoop&rdquo; - @GevuldeCookie</i> quote. You can view this in the DevTools (F12) or using a proxy like Burp. For now I will use the browser as the tool to examine web traffic.
</p>


<figure id="org4901d50">
<img src="index_att/devtools-cookie.png" alt="devtools-cookie.png">

<figcaption><span class="figure-number">Figure 1: </span>Authenticated cookie in the devtools</figcaption>
</figure>

<p>
The cookie is called &ldquo;authenticated&rdquo; and has a value that starts with <code>eyJ</code>. You will soon get familiar with identifying <code>JSON</code> datastructures in Base64 as they always start with the combination <code>{"</code> followed by some characters. That combination converts to <code>eyJ</code> in Base64.
</p>

<p>
As it is clear that it is a Base64 encoded string it can be copied over to <a href="https://gchq.github.io/CyberChef">CyberChef</a>. You might notice, whily copying, that the string ends in <code>%3D</code>. This is the URL encoding of an <code>=</code> sign. We could replace this manually, but CyberChef has decoders for this purpose. Select the <i>URL Decoder</i> and <i>From Base64</i> and drag them to the recipe column.
</p>


<figure id="orgf4066ef">
<img src="index_att/cyberchef-decode.png" alt="cyberchef-decode.png">

<figcaption><span class="figure-number">Figure 1: </span>Decoding the string in CyberChef</figcaption>
</figure>

<p>
The JSON structure is visible now. It reads <code>{"guest":"true","admin":"false"}</code>. You can try various combinations of <code>true</code> and <code>false</code>. In order to solve the challenge the <code>guest</code> needs to be set to <code>false</code> and <code>admin</code> to <code>true</code>. Remove the previously used decoders from the recipe and add the <code>To Base64</code> encoder to create the payload.
</p>


<figure id="orge7cc0b9">
<img src="index_att/encode-base64.png" alt="encode-base64.png">

<figcaption><span class="figure-number">Figure 1: </span>Encode Base64 payload</figcaption>
</figure>

<p>
Go to your browser, change the value of the cookie (double click on it), and reload the page. You will now be presented with the flag for this challenge.
</p>


<figure id="orgfc60a1f">
<img src="index_att/flag.png" alt="flag.png">

<figcaption><span class="figure-number">Figure 1: </span>Challenge flag</figcaption>
</figure>

<p>
Go and grab your points in the CTFd dashboard. Also, don&rsquo;t forget to grab the beautiful badge that you can share on your social media to promote the Advent of CTF!.
</p>


<figure id="orge7a0cbc">
<img src="index_att/badge.png" alt="badge.png">

<figcaption><span class="figure-number">Figure 1: </span>Badge for challenge 2</figcaption>
</figure>

<p>
The challenge is solved.
</p>

<p>
Go back to the <a href="../../../index.html">homepage</a>.
</p>
</div>
</section>
</main>
<footer id="postamble" class="status">
<p class="author">Author: Arjen Wiersma</p>
<p class="date">Created: 21 Dec. 2022</p>
</footer>
</body>
</html>