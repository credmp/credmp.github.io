<!DOCTYPE html>
<html lang="en">
<head>
<!-- 21 Dec. 2022 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs Advent of Code helper</title>
<meta name="author" content="Arjen Wiersma" />
<meta name="generator" content="Org Mode" />
<meta description='Writings by Arjen'/>
<link rel='alternate' type='application+rss/xml' title='Writings by Arjen' href='/posts/rss.xml'/>
<link rel="stylesheet" href="../../css/theme.css?v=20216e086cf8a20ead56908f3be0bcda6af2531ec1a68c9058ee7495590f57ea" type="text/css">
</head>
<body>
<main id="content" class="content">
<header>
<h1 class="title">Emacs Advent of Code helper</h1>
<p class="subtitle" role="doc-subtitle">Grab your input like a pro</p>
</header><p>
One step in solving the <a href="https://adventofcode.com">Advent of Code</a> challenges is to grab the puzzle input. This step is easily automated within Emacs.
</p>

<p>
The following function reads the year and day from the input and then inserts the contents of the url into the current buffer. This works quite nicely.
</p>

<p>
<b>Updated</b>: it now uses the current date as input unless it is prefixed (<code>C-u</code>). When prefixed you can give it a year and a date and it will pull in that specific input.
</p>

<p>
<b>Another update</b>: a temp buffer will pop up that will display the text of the puzzle.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org63b2f96">(<span class="org-keyword">defun</span> <span class="org-function-name">aw/aoc-get-puzzle-and-input</span> (prefix)
  <span class="org-doc">"Retrieve the input for an advent of code puzzle. Use a prefix</span>
<span class="org-doc">to retrieve for a specific year or day. The input is inserted into the current</span>
<span class="org-doc">buffer, a new buffer will be made with the description of the puzzle."</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"p"</span>)
  (<span class="org-keyword">let*</span> ((year  (<span class="org-keyword">cond</span> ((= prefix 1)
                       (string-to-number (format-time-string <span class="org-string">"%Y"</span>)))
                      ((&gt; prefix 1)
                       (read-number <span class="org-string">"Year: "</span>))))
         (day (<span class="org-keyword">cond</span> ((= prefix 1)
                     (string-to-number (format-time-string <span class="org-string">"%d"</span>)))
                    ((&gt; prefix 1)
                     (read-number <span class="org-string">"Day: "</span>))))
         (creds (auth-source-search <span class="org-builtin">:host</span> <span class="org-string">"adventofcode.com"</span>))
         (secret (plist-get (car creds) <span class="org-builtin">:secret</span>))
         (decoded (funcall secret))
         (url-request-extra-headers `((<span class="org-string">"Cookie"</span> . ,(concat <span class="org-string">"session="</span> decoded)))))
    (url-insert-file-contents (format <span class="org-string">"https://adventofcode.com/%d/day/%d/input"</span> year day))
    (<span class="org-keyword">with-output-to-temp-buffer</span> <span class="org-string">"aoc-puzzle"</span>
        (pop-to-buffer <span class="org-string">"aoc-puzzle"</span>)
        (url-insert-file-contents (format <span class="org-string">"https://adventofcode.com/%d/day/%d"</span> year day))
        (shr-render-region (point-min) (point-max)))
    ))
</pre>
</div>

<p>
In order for it to work it is required to grab the <code>session</code> cookie from the website, just hist <code>F12</code>, scroll to <code>storage</code> and copy the hash you see there.
</p>


<figure id="orgf78d490">
<img src="./images/storage.png" alt="storage.png">

</figure>

<p>
Add this <code>hash</code> to your <code>.authinfo</code> file.
</p>

<pre class="example">
machine adventofcode.com password 1234YOURHASHHERE
</pre>

<p>
Emacs will now happily grab the input for you and insert it into the current buffer and show you the challenge ahead.
</p>

<p>
Go back to the <a href="../../index.html">homepage</a>.
</p>
</main>
</body>
</html>