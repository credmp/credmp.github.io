<!DOCTYPE html>
<html lang="en">
<head>
<!-- 21 Dec. 2022 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>POP_OS! Pipewire</title>
<meta name="author" content="Arjen Wiersma" />
<meta name="generator" content="Org Mode" />
<meta description='Writings by Arjen'/>
<link rel='alternate' type='application+rss/xml' title='Writings by Arjen' href='/posts/rss.xml'/>
<link rel="stylesheet" href="../../css/theme.css?v=20216e086cf8a20ead56908f3be0bcda6af2531ec1a68c9058ee7495590f57ea" type="text/css">
</head>
<body>
<main id="content" class="content">
<header>
<h1 class="title">POP_OS! Pipewire</h1>
<p class="subtitle" role="doc-subtitle">Upgrade your sound in Linux</p>
</header>
<section id="outline-container-orgaac3b4b" class="outline-2">
<h2 id="orgaac3b4b">Pipewire</h2>
<div class="outline-text-2" id="text-orgaac3b4b">
<p>
According to <a href="https://pipewire.org/">its website</a>:
</p>

<blockquote>
<p>
PipeWire is a project that aims to greatly improve handling of audio and video under Linux. It provides a low-latency, graph based processing engine on top of audio and video devices that can be used to support the use cases currently handled by both pulseaudio and JACK. PipeWire was designed with a powerful security model that makes interacting with audio and video devices from containerized applications easy, with supporting Flatpak applications being the primary goal.
</p>
</blockquote>

<p>
In other words, it replaces the current audio system with a system that is modular and ready for the future.
</p>
</div>

<div id="outline-container-org166bf27" class="outline-3">
<h3 id="org166bf27">Checking what you are running now</h3>
<div class="outline-text-3" id="text-org166bf27">
<p>
Using the command <code>pactl info</code> you can check to see what version of the audio system you are using. When you run only <code>PulseAudio</code> the output will include the following:
</p>

<pre class="example" id="orgd86afea">
Server Name: PulseAudio
</pre>

<p>
When you have taken the steps in this article the output will look like the following:
</p>

<pre class="example">
Server String: /run/user/1000/pulse/native
Library Protocol Version: 34
Server Protocol Version: 35
Is Local: yes
Client Index: 50
Tile Size: 65472
User Name: arjen
Host Name: beta
Server Name: PulseAudio (on PipeWire 0.3.40)
Server Version: 15.0.0
Default Sample Specification: float32le 2ch 48000Hz
Default Channel Map: front-left,front-right
Default Sink: alsa_output.pci-0000_0c_00.3.analog-stereo
Default Source: alsa_input.usb-046d_Logitech_BRIO_B48C2639-03.analog-stereo
Cookie: 678c:13a1
</pre>
</div>
</div>
</section>

<section id="outline-container-orgd0448a5" class="outline-2">
<h2 id="orgd0448a5">Enable it in POP_OS</h2>
<div class="outline-text-2" id="text-orgd0448a5">
<p>
Pipewire lives in <code>userland</code>, meaning that it is a service that is run whenever a user is logged into a session. First you will need to add the <code>ppa</code> for <code>pipewire-upstream</code> and <code>update</code> your repositories. 
</p>

<div class="org-src-container">
<pre class="src src-shell">sudo add-apt-repository ppa:pipewire-debian/pipewire-upstream -y
sudo apt update
sudo apt upgrade -y
sudo apt install -y pipewire gstreamer1.0-pipewire pipewire-pulse <span class="org-sh-escaped-newline">\</span>
     libspa-0.2-bluetooth libspa-0.2-jack pipewire-audio-client-libraries
</pre>
</div>

<p>
For <b>each user</b> that wants to run Pipewire you need to enable it using <code>systemctl</code>. Afterwards you need to reboot.
</p>

<div class="org-src-container">
<pre class="src src-shell">systemctl --user mask pulseaudio
systemctl --user --now disable pulseaudio.service pulseaudio.socket
systemctl --user --now enable pipewire-media-session.service
systemctl reboot
</pre>
</div>

<p>
If you ever need to switch back to <code>PulseAudio</code> the steps are quite easy:
</p>

<div class="org-src-container">
<pre class="src src-shell">systemctl --user unmask pulseaudio 
systemctl --user --now disable pipewire-media-session.service
systemctl --user --now enable pulseaudio.service pulseaudio.socket
systemctl reboot
</pre>
</div>
</div>
</section>

<section id="outline-container-org49d8241" class="outline-2">
<h2 id="org49d8241">Cadence and Catia</h2>
<div class="outline-text-2" id="text-org49d8241">
<p>
The <code>Cadence</code> and <code>Catia</code> tools are extremely useful when working with audio. To get them, first add the <code>kx.studio</code> repositories.
</p>

<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">Install required dependencies if needed</span>
sudo apt-get install apt-transport-https gpgv

<span class="org-comment-delimiter"># </span><span class="org-comment">Remove legacy repos</span>
sudo dpkg --purge kxstudio-repos-gcc5

<span class="org-comment-delimiter"># </span><span class="org-comment">Download package file</span>
wget https://launchpad.net/~kxstudio-debian/+archive/kxstudio/+files/kxstudio-repos_10.0.3_all.deb

<span class="org-comment-delimiter"># </span><span class="org-comment">Install it</span>
sudo dpkg -i kxstudio-repos_10.0.3_all.deb
</pre>
</div>

<p>
Then install the applications:
</p>

<div class="org-src-container">
<pre class="src src-shell">sudo apt install carla-git cadence
</pre>
</div>

<p>
You can then use <code>Catia</code> to modify how sound is routed in your environment. You can for instance route the output of your Firefox session into the input of Discord, thereby sharing your sound with your friends. The below screenshot shows the default view in <code>Catia</code> for my environment.
</p>


<figure id="org6cd810a">
<img src="./images/catia.png" alt="catia.png">

</figure>

<p>
Go back to the <a href="../../index.html">homepage</a>.
</p>
</div>
</section>
</main>
</body>
</html>