<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/ico href=https://www.arjenwiersma.nl//favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.arjenwiersma.nl//favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.arjenwiersma.nl//favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https://www.arjenwiersma.nl//android-chrome-192x192.png><link rel=apple-touch-icon sizes=180x180 href=https://www.arjenwiersma.nl//apple-touch-icon.png><meta name=description content><meta property="og:image" content="https://www.arjenwiersma.nl/social.png"><title>Badge Challenge 3 | Arjen Wiersma
</title><link rel=canonical href=https://www.arjenwiersma.nl/posts/badge-challenge-3/><link rel=stylesheet href=/assets/combined.min.a6824bbee0d90d5af09fed9b70395ce7076b615e315037455d903314e96ef91b.css media=all></head><body class=auto><div class=content><header><div class=header><h1 class=header-title>Arjen Wiersma</h1><div class=flex><p class=small><a href=/>/home</a></p><p class=small><a href=/posts>/posts</a></p><p class=small><a href=/tags>/tags</a></p></div></div></header><main class=main><div class=breadcrumbs><a href=/>Home</a>
<span class=breadcrumbs-separator>> </span><a href=/posts/>Posts</a>
<span class=breadcrumbs-separator>> </span><a class=breadcrumbs-current href=/posts/badge-challenge-3/>Badge Challenge 3</a></div><div><div class=single-intro-container><h1 class=single-title>Badge Challenge 3</h1><p class=single-readtime><time datetime=2023-03-12T12:10:00+01:00>12 Mar 2023</time></p></div><div class=single-content><h2 id=original-post>Original Post</h2><p>During each in-person Hack The Box meetup I have a small badge challenge that will give the first solver of the challenge a price. at the meetup of March 2023 there will be a very nice little challenge to be done as well, a beautiful NOVI hoodie. You can already download the password protected zip archive. The password will be shared during the meetup opening words.</p><ul><li><a href=/files/badge3.zip>The zip archive</a> (sha1: 28e84243c79caefce06f62ba2c5d930de37a3439)</li></ul><p>Good luck. Afterwards I will post a walkthrough of the challenge on this site. Badge Life is hard :)</p><h2 id=walkthrough>Walkthrough</h2><p>As usual, the solving of this challenge did not go as expected.</p><p>When you first receive the challenge a quick binary analysis will show you that there is a condition of the passphrase. It has to <strong>24</strong> characters in length and the ascii value has to sum up to <strong>2137</strong>. During the meetup there were some hints as to how to find the passphrase, namely that I said that I posted in <strong>LinkedIn</strong> about the challenge and Salp had a <em>&ldquo;credmp talks too much&rdquo;</em> on his badge. Sadly the hints were not picked up and people started writing bruteforcers for gigantic dictionaries. Eventually I updated my initial blog post to have all the information that was necessary so that the challenge could be solved.</p><p>A wise lesson here is to not rely on multiple sources for the challenge, and if so, make it much more direct. What should&rsquo;ve been a fun, quick, bruteforcers ended up in a days long torment.</p><p>The original LinkedIn message on the badge challenge had all the information that was required. Lets check it out in the following figure.</p><figure><img src=/ox-hugo/linkedin-badge-challenge.png alt="The linkedin post" width=100%></figure><p>By creating a bruteforcer, as MrHaas did for the blog post, a script as the following could be created.</p><p></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>from</span> <span style=font-weight:700>itertools</span> <span style=font-weight:700>import</span> combinations, permutations
</span></span><span style=display:flex><span><span style=font-weight:700>from</span> <span style=font-weight:700>tqdm</span> <span style=font-weight:700>import</span> tqdm
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> <span style=font-weight:700>pwn</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pwn.context.log_level = <span style=font-style:italic>&#34;error&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>post = <span style=font-style:italic>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=font-style:italic>    Badge Challenge 3
</span></span></span><span style=display:flex><span><span style=font-style:italic>March 12, 2023 · 1 min · Arjen Wiersma
</span></span></span><span style=display:flex><span><span style=font-style:italic>During each in-person Hack The Box meetup I have a small badge challenge that will give the first solver of the challenge a price. at the meetup of March 2023 there will be a very nice little challenge to be done as well, a beautiful NOVI hoodie. You can already download the password protected zip archive. The password will be shared during the meetup opening words.
</span></span></span><span style=display:flex><span><span style=font-style:italic>    The zip archive (sha1: 28e84243c79caefce06f62ba2c5d930de37a3439)
</span></span></span><span style=display:flex><span><span style=font-style:italic>Good luck. Afterwards I will post a walkthrough of the challenge on this site.
</span></span></span><span style=display:flex><span><span style=font-style:italic>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>def</span> ssum(s):
</span></span><span style=display:flex><span>    <span style=font-weight:700>return</span> sum(ord(c) <span style=font-weight:700>for</span> c <span style=font-weight:700>in</span> s)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>def</span> iter_passphrases(words, n):
</span></span><span style=display:flex><span>    <span style=font-weight:700>for</span> comb <span style=font-weight:700>in</span> combinations(words, n):
</span></span><span style=display:flex><span>        <span style=font-weight:700>if</span> sum(len(word) <span style=font-weight:700>for</span> word <span style=font-weight:700>in</span> comb) != (24 - n + 1):
</span></span><span style=display:flex><span>            <span style=font-weight:700>continue</span>
</span></span><span style=display:flex><span>        <span style=font-weight:700>if</span> sum(ssum(word) <span style=font-weight:700>for</span> word <span style=font-weight:700>in</span> comb) != (2137 - (n - 1) * 32):
</span></span><span style=display:flex><span>            <span style=font-weight:700>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=font-weight:700>for</span> perm <span style=font-weight:700>in</span> permutations(comb):
</span></span><span style=display:flex><span>            <span style=font-weight:700>yield</span> <span style=font-style:italic>&#34; &#34;</span>.join(perm)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>if</span> __name__ == <span style=font-style:italic>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    word_list = open(<span style=font-style:italic>&#34;./dutch_common_wordlist.txt&#34;</span>).read().split()
</span></span><span style=display:flex><span>    words = [word.strip(<span style=font-style:italic>&#34;.?!()#&#34;</span>) <span style=font-weight:700>for</span> word <span style=font-weight:700>in</span> post.split()]
</span></span><span style=display:flex><span>    overlap = set(word_list) &amp; set(words) | {<span style=font-style:italic>&#34;Life&#34;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>for</span> n <span style=font-weight:700>in</span> range(3, 6):
</span></span><span style=display:flex><span>        print(<span style=font-style:italic>f</span><span style=font-style:italic>&#34;Trying </span><span style=font-weight:700;font-style:italic>{</span>n<span style=font-weight:700;font-style:italic>}</span><span style=font-style:italic> words&#34;</span>)
</span></span><span style=display:flex><span>        <span style=font-weight:700>for</span> passphrase <span style=font-weight:700>in</span> tqdm(iter_passphrases(overlap, n)):
</span></span><span style=display:flex><span>            <span style=font-weight:700>with</span> pwn.process([<span style=font-style:italic>&#34;./badge3&#34;</span>, passphrase]) <span style=font-weight:700>as</span> ps:
</span></span><span style=display:flex><span>                result = ps.recvall()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=font-weight:700>if</span> <span style=font-style:italic>b</span><span style=font-style:italic>&#34;Sorry&#34;</span> <span style=font-weight:700>not</span> <span style=font-weight:700>in</span> result:
</span></span><span style=display:flex><span>                    print(passphrase)
</span></span><span style=display:flex><span>                    print(result.decode())
</span></span><span style=display:flex><span>                    <span style=font-weight:700>break</span>
</span></span></code></pre></div><p>More interestingly, chatgpt can be leveraged to create a brute forcing program, however it is not very good. ChatGPT gets confused on how to use the itertools package to generate the combinations. However, it is a good starting template.</p><figure><img src=/ox-hugo/badge3-chatgpt.png alt="Getting help from ChatGPT" width=100%></figure><p>Finally, here is the actual Rust code for the challenge.</p><p></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=font-weight:700>use</span> std::env;
</span></span><span style=display:flex><span><span style=font-weight:700>use</span> std::<span>str</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>fn</span> main() {
</span></span><span style=display:flex><span>    <span style=font-weight:700>let</span> <span style=font-weight:700>mut</span> args: Vec&lt;String&gt; = env::args().collect();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(
</span></span><span style=display:flex><span><span style=font-style:italic>&#34;
</span></span></span><span style=display:flex><span><span style=font-style:italic>Badge Life (in ASCII art)
</span></span></span><span style=display:flex><span><span style=font-style:italic>&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>if</span> args.len() == 1 {
</span></span><span style=display:flex><span>        println!(<span style=font-style:italic>&#34;Usage: </span><span style=font-weight:700;font-style:italic>{}</span><span style=font-style:italic> passphrase&#34;</span>, args[0]);
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    args.remove(0);
</span></span><span style=display:flex><span>    <span style=font-weight:700>let</span> pass = args.join(<span style=font-style:italic>&#34; &#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>let</span> <span style=font-weight:700>mut</span> sum = 0;
</span></span><span style=display:flex><span>    <span style=font-weight:700>for</span> p <span style=font-weight:700>in</span> pass.chars() {
</span></span><span style=display:flex><span>        sum = sum + (p <span style=font-weight:700>as</span> <span>i32</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>if</span> pass.len() != 24 &amp;&amp; sum != 2137 {
</span></span><span style=display:flex><span>        println!(
</span></span><span style=display:flex><span>            <span style=font-style:italic>&#34;That is not a correct passphrase (len </span><span style=font-weight:700;font-style:italic>{}</span><span style=font-style:italic> sum </span><span style=font-weight:700;font-style:italic>{}</span><span style=font-style:italic>), try again!&#34;</span>,
</span></span><span style=display:flex><span>            pass.len(),
</span></span><span style=display:flex><span>            sum
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=font-style:italic>&#34;That might work.... lets try it!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>let</span> password = pass.as_bytes();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>let</span> encrypted = [
</span></span><span style=display:flex><span>        166, 245, 144, 245, 161, 25, 252, 210, 105, 138, 33, 57, 160, 128, 18, 25, 38, 0, 0, 0, 0,
</span></span><span style=display:flex><span>        0, 0, 0, 6, 171, 134, 183, 188, 103, 63, 69, 199, 190, 26, 116, 174, 217, 135, 232, 211,
</span></span><span style=display:flex><span>        26, 102, 245, 226, 186, 82, 70, 104, 59, 170, 231, 162, 92, 120, 130, 135, 108, 134, 108,
</span></span><span style=display:flex><span>        22, 81,
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>let</span> plain = simplestcrypt::deserialize_and_decrypt(&amp;password[..], &amp;encrypted);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>match</span> plain {
</span></span><span style=display:flex><span>        Ok(v) =&gt; {
</span></span><span style=display:flex><span>            <span style=font-weight:700>let</span> conv = <span>str</span>::from_utf8(&amp;v);
</span></span><span style=display:flex><span>            <span style=font-weight:700>match</span> conv {
</span></span><span style=display:flex><span>                Ok(key) =&gt; println!(<span style=font-style:italic>&#34;Here is the key: </span><span style=font-weight:700;font-style:italic>{:?}</span><span style=font-style:italic>&#34;</span>, key),
</span></span><span style=display:flex><span>                Err(_) =&gt; println!(<span style=font-style:italic>&#34;Sorry, it was not the right phrase&#34;</span>),
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        Err(_) =&gt; {
</span></span><span style=display:flex><span>            println!(<span style=font-style:italic>&#34;Sorry, it was not the right phrase&#34;</span>);
</span></span><span style=display:flex><span>            <span style=font-weight:700>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The passphrase was: <strong>Badge Life at The meetup</strong></p></div><div class=single-pagination><hr><div class=flex><div class=single-pagination-prev><div class=single-pagination-container-prev><div class=single-pagination-text>←</div><div class=single-pagination-text><a href=/posts/deployment-anxiety/>Deployment Anxiety</a></div></div></div><div class=single-pagination-next><div class=single-pagination-container-next><div class=single-pagination-text><a href=/posts/ou-sqm/>Open Universiteit: Software Quality Management</a></div><div class=single-pagination-text>→</div></div></div></div><hr></div><div class=back-to-top><a href=#top>back to top</a></div></div></main></div><footer><p>Powered by
<a href=https://gohugo.io/>Hugo</a>
and
<a href=https://github.com/tomfran/typo>tomfran/typo</a></p></footer></body><script>function isAuto(){return document.body.classList.contains("auto")}function setTheme(){if(!isAuto())return;document.body.classList.remove("auto");let e="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),document.body.classList.add(e)}function invertBody(){document.body.classList.toggle("dark"),document.body.classList.toggle("light")}isAuto()&&window.matchMedia("(prefers-color-scheme: dark)").addListener(invertBody),setTheme()</script></html>